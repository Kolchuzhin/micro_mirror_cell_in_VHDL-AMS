function fr=cap12(q1,q2,q3,key)
%=========================================================================%
% PURPOSE:
% to evaluate the capacitance at the operating point (q1,q2,q3)
% uMKSV units
%
% dependencies, external functions:
%       (ROMOPER.m)
%       spoly_calc.m (code from vhdl-ams model: transducer.vhd)
%
% INPUT:
%           q1,q2,q3,key
% OUTPUT:   fr
%-------------------------------------------------------------------------%
% Kolchuzhin V.A., LMGT, TU Chemnitz, 03.05.2011 14:26
% <vladimir.kolchuzhin@etit.tu-chemnitz.de>
% 24.05.2011 17:11
%
%=========================================================================%
if nargin==0 % self-test
    q1=0.0; q2=0.0; q3=0.0; key=1;
    % C12(0,0,0)=0.054850205210366 pF
end
%-------------------------------------------------------------------------%
% data: ca12_ams_130.vhd
ca_type=1;
ca_inve=2;
ca_ord=[4.0, 3.0, 0.0];
ca_fak=[0.975294676147E-01, 0.220185632619, 0.00000000000, 25.6028993526];
ca_anz=20;
ca_data=[...
  0.712086240885    
  0.186297166892    
 -0.208887154143E-01
  0.531007092724E-02
 -0.181480706895E-02
  0.128558883926    
 -0.939139994662E-02
  0.372136915760E-02
 -0.259077537559E-02
  0.104687708202E-02
 -0.293936530550E-02
  0.667614364241E-03
 -0.506853279164E-03
  0.113773216487E-02
 -0.947577210652E-03
  0.196412408079E-03
  0.637444737511E-04
 -0.129103797161E-03
 -0.532315735795E-03
  0.644951605279E-03
];
%-------------------------------------------------------------------------%
[fwv, dfwvx, dfwvy, dfwvz]=spoly_calc(q1,q2,q3,ca_type,ca_inve,ca_ord,ca_fak,ca_data);
%-------------------------------------------------------------------------%
fr=[];

if key==1 fr=fwv; end % capacitance
if key==2 fr=[dfwvx; dfwvy;]; end % electostatic force
%-------------------------------------------------------------------------%
return
