function fr=cap23(q1,q2,q3,key)
%=========================================================================%
% PURPOSE:
% to evaluate the capacitance at the operating point (q1,q2,q3)
% uMKSV units
%
% dependencies, external functions:
%       (ROMOPER.m)
%       spoly_calc.m (code from vhdl-ams model: transducer.vhd)
%
% INPUT:
%           q1,q2,q3,key
% OUTPUT:   fr
%-------------------------------------------------------------------------%
% Kolchuzhin V.A., LMGT, TU Chemnitz, 03.05.2011 14:26
% <vladimir.kolchuzhin@etit.tu-chemnitz.de>
% 24.05.2011 17:11
%
%=========================================================================%
if nargin==0 % self-test
    q1=0.0; q2=0.0; q3=0.0; key=1;
    % C12(0,0,0)=0.054850205210366 pF
    % C13(0,0,0)=0.054849369770885 pF
    % C23(0,0,0)=4.206410480939404e-004 pF
end
%-------------------------------------------------------------------------%
% data: ca23_ams_130.vhd
ca_type=1;
ca_inve=2;
ca_ord=[4.0, 3.0, 0.0];
ca_fak=[0.975294676147E-01, 0.220185632619, 0.00000000000, 4353.18490300];
ca_anz=20;
ca_data=[...
  0.546111390319    
  0.295871790946E-03
  0.879069075222E-02
 -0.293891270388E-03
 -0.641224996279E-03
 -0.263461122282    
 -0.718573965052E-03
 -0.864593553516E-03
  0.173269568371E-02
 -0.516914738996E-02
  0.125610539761    
 -0.128446242254E-02
  0.499953901998E-02
  0.127235001362E-02
 -0.131318972091E-02
 -0.444623172071E-01
  0.163315957039E-02
 -0.909045625811E-02
 -0.260866762118E-02
  0.702268147666E-02 
];
%-------------------------------------------------------------------------%
[fwv, dfwvx, dfwvy, dfwvz]=spoly_calc(q1,q2,q3,ca_type,ca_inve,ca_ord,ca_fak,ca_data);
%-------------------------------------------------------------------------%
fr=[];

if key==1 fr=fwv; end % capacitance
if key==2 fr=[dfwvx; dfwvy;]; end % electostatic force
%-------------------------------------------------------------------------%
return
