function fr=cap13(q1,q2,q3,key)
%=========================================================================%
% PURPOSE:
% to evaluate the capacitance at the operating point (q1,q2,q3)
% uMKSV units
%
% dependencies, external functions:
%       (ROMOPER.m)
%       spoly_calc.m (code from vhdl-ams model: transducer.vhd)
%
% INPUT:
%           q1,q2,q3,key
% OUTPUT:   fr
%-------------------------------------------------------------------------%
% Kolchuzhin V.A., LMGT, TU Chemnitz, 03.05.2011 14:26
% <vladimir.kolchuzhin@etit.tu-chemnitz.de>
% 24.05.2011 17:11
%
%=========================================================================%
if nargin==0 % self-test
    q1=0.0; q2=0.0; q3=0.0; key=1;
    % C12(0,0,0)=0.054850205210366 pF
    % C13(0,0,0)=0.054849369770885 pF
end
%-------------------------------------------------------------------------%
% data: ca13_ams_130.vhd
ca_type=1;
ca_inve=2;
ca_ord=[4.0, 3.0, 0.0];
ca_fak=[0.975294676147E-01, 0.220185632619, 0.00000000000, 25.6030000457];
ca_anz=20;
ca_data=[...
  0.712094286463    
 -0.186347802870    
 -0.209412180795E-01
 -0.523557199207E-02
 -0.178345484280E-02
  0.128565735753    
  0.931339715905E-02
  0.363612109234E-02
  0.264112674223E-02
  0.111307000174E-02
 -0.294786738552E-02
 -0.533796708169E-03
 -0.463952089322E-03
 -0.131455480646E-02
 -0.989450152969E-03
  0.190516958085E-03
  0.124293432457E-04
 -0.498349836548E-04
  0.494604396684E-03
  0.599958313911E-03
];
%-------------------------------------------------------------------------%
[fwv, dfwvx, dfwvy, dfwvz]=spoly_calc(q1,q2,q3,ca_type,ca_inve,ca_ord,ca_fak,ca_data);
%-------------------------------------------------------------------------%
fr=[];

if key==1 fr=fwv; end % capacitance
if key==2 fr=[dfwvx; dfwvy;]; end % electostatic force
%-------------------------------------------------------------------------%
return
