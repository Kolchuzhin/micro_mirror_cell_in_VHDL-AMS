function fr=sene(q1,q2,q3,key)
%=========================================================================%
% PURPOSE:
% to evaluate the strain energy at the operating point (q1,q2,q3)
% uMKSV units
%
% dependencies, external functions: 
%                        polynomial evaluating function
%                        spoly_calc.m (code from vhdl-ams model:
%                        transducer.vhd)
% INPUT:
%           q1,q2,q3,key
% OUTPUT:   fr
%-------------------------------------------------------------------------%
% Kolchuzhin V.A., LMGT, TU Chemnitz, 03.05.2011 14:26
% <vladimir.kolchuzhin@etit.tu-chemnitz.de>
% 24.05.2011 17:11
%=========================================================================%
if nargin==0 % self-test
    q1=0.0; q2=0.0; q3=0.0; key=2;
end
%-------------------------------------------------------------------------%
% data: s_ams_130.vhd
s_type=1;
s_inve=1;
s_ord=[4.0, 3.0, 0.0];
s_fak=[0.975294676147E-01, 0.220185632619, 0.0, 18627.65044];
s_anz=      20;
s_data=[...
 -0.211963583064E-10,
  0.303852586068E-16,
  0.488293553651    ,
 -0.966803682459E-16,
 -0.289764466026E-10,
 -0.289421473806E-15,
 -0.591831967134E-11,
  0.126983139929E-14,
 -0.828445060518E-10,
 -0.985214016685E-15,
  0.511706446310    ,
 -0.711031743701E-16,
 -0.100354073641E-09,
  0.226237372945E-15,
 -0.847945860260E-10,
  0.321621459155E-15,
  0.467129041343E-09,
 -0.141110824345E-14,
 -0.103557104018E-09,
  0.109482536129E-14 
];
%-------------------------------------------------------------------------%
[fwv, dfwvx, dfwvy, dfwvz]=spoly_calc(q1,q2,q3,s_type,s_inve,s_ord,s_fak,s_data);
%-------------------------------------------------------------------------%
fr=[];

if key==1 fr=fwv; end % strain energy
if key==2 fr=[dfwvx; dfwvy;]; end % reaction force
%-------------------------------------------------------------------------%
return
